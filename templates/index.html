<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Config Downloader</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: Arial, sans-serif;
        background: #0f172a;
        color: #e5e7eb;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      .card {
        background: #020617;
        padding: 25px;
        border-radius: 10px;
        width: 360px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      }

      h1 {
        text-align: center;
        margin-bottom: 20px;
        color: #ffffff;
      }

      .info {
        margin: 10px 0;
        font-size: 15px;
        color: #ffffff;
      }

      .status {
        margin-top: 15px;
        padding: 10px;
        background: #020617;
        border-radius: 6px;
        font-size: 14px;
        color: #93c5fd;
      }

      .btn-custom {
        width: 100%;
        margin-top: 12px;
        padding: 12px;
        border-radius: 6px;
        font-size: 16px;
      }

      .btn-old {
        background: #cecece;
        color: #000000;
      }

      .btn-new {
        background: #e9e9e9;
        color: #000000;
      }

      .btn-config {
        background: #ffffff;
        color: #000000;
      }
      .btn-icon {
        width: 22px;
        height: 22px;
        margin-right: 8px;
        object-fit: contain;
      }
      .btn-icon-gerador {
        width: 32px;
        height: 32px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Config Downloader</h1>

      <div class="info">üìÇ Arquivos no bucket: <span id="files">0</span></div>
      <div class="info">
        ‚è±Ô∏è Tempo para liberar: <span id="timer">--:--</span>
      </div>

      <div class="status">üìÑ Status: <span id="msg">---</span></div>

      <button onclick="baixarApkOld()" class="btn btn-custom btn-old">
        <img
          src="https://unitvapks.com.br/wp-content/uploads/2025/11/UniTV-APK-1.webp"
          class="btn-icon"
        />APK OLD
      </button>

      <button onclick="baixarApkNew()" class="btn btn-custom btn-new">
        <img
          src="https://unitvapks.com.br/wp-content/uploads/2025/11/UniTV-APK-1.webp"
          class="btn-icon"
        />
        APK NEW
      </button>

      <button onclick="baixarGerador()" class="btn btn-custom btn-config">
        <img
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQvaivJ6JJQiGxI9ZsZOdTQdkcFqzzDFLQXZQ&s"
          class="btn-icon btn-icon-gerador"
        />
        GERADOR
      </button>
    </div>

    <script>
      let interval = null;

      async function loadStatus() {
        const res = await fetch("/status");
        const data = await res.json();

        document.getElementById("files").innerText = data.files;
        document.getElementById("msg").innerText = data.mensagem;

        if (data.tempo_para_liberar) {
          startTimer(data.tempo_para_liberar);
        } else {
          document.getElementById("timer").innerText = "--:--";
        }
      }

      function startTimer(seconds) {
        clearInterval(interval);

        interval = setInterval(() => {
          if (seconds <= 0) {
            clearInterval(interval);
            loadStatus();
            return;
          }

          const m = String(Math.floor(seconds / 60)).padStart(2, "0");
          const s = String(seconds % 60).padStart(2, "0");

          document.getElementById("timer").innerText = `${m}:${s}`;
          seconds--;
        }, 1000);
      }

      function download(url) {
        const a = document.createElement("a");
        a.href = url;
        a.download = "";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }

      // Downloads
      function baixarApkOld() {
        window.location.href =
          "https://github.com/tikolol96-glitch/LICENCAS-UNITV/releases/download/APK/UniTV_OLD.apk";
      }

      function baixarApkNew() {
        window.location.href =
          "https://github.com/tikolol96-glitch/LICENCAS-UNITV/releases/download/APK/UniTV_NEW.apk";
      }

      function baixarGerador() {
        window.location.href =
          "https://github.com/tikolol96-glitch/LICENCAS-UNITV/releases/download/APK/gerador.apk";
      }

      // Inicializa√ß√£o
      loadStatus();
      setInterval(loadStatus, 10000);
    </script>
  </body>
</html>
